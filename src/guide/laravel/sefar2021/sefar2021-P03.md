# Proyecto App Sefar Universal 2021 (Parte III)
+ Versión: **Laravel Framework 8.31.0**


## CRUD Familiares
1. Crear modelo Family junto con su migración y controlador y los métodos para el CRUD:
	+ $ php artisan make:model Family -m -c -r
2. Preparar migración para la tabla **families** en **database\migrations\2021_03_30_010102_create_families_table.php**
	```php
    ≡
    public function up()
    {
        Schema::create('families', function (Blueprint $table) {
            $table->id();
            $table->string('IDCombinado',175)->unique();
            $table->string('IDCliente',175);
            $table->string('Cliente')->nullable();
            $table->string('IDFamiliar');
            $table->string('Familiar')->nullable();
            $table->string('Parentesco')->nullable();
            $table->string('Lado')->nullable();
            $table->string('Rama')->nullable();
            $table->text('Nota')->nullable();
            $table->timestamps();
        });
    }
    ≡
    ```
3. Establecer permisos en los seeders para el CRUD Paises en **database\seeders\RoleSeeder.php**:
	```php
    ≡ 
    public function run()
    {
        ≡        
        Permission::create(['name' => 'crud.families.index'])->syncRoles($rolAdministrador, $rolGenealogista);
        Permission::create(['name' => 'crud.families.create'])->syncRoles($rolAdministrador, $rolGenealogista);
        Permission::create(['name' => 'crud.families.edit'])->syncRoles($rolAdministrador, $rolGenealogista);
        Permission::create(['name' => 'crud.families.destroy'])->syncRoles($rolAdministrador);
        ≡
    }
    ≡
    ```
4. Reestablecer base de datos: 
	+ $ php artisan migrate:fresh --seed
5. Configurar modelo **Family** en **app\Models\Family.php**
	```php
    ≡
    class Family extends Model
    {
        use HasFactory;

        protected $fillable = [
            'IDCombinado',
            'IDCliente',
            'Cliente',
            'IDFamiliar',
            'Familiar',
            'Parentesco',
            'Lado',
            'Rama',
            'Nota'
        ];
    }
    ```
6. Agregar ruta families al grupo de rutas CRUD:
	```php
    Route::resource('families', FamilyController::class)->names('families')
            ->middleware('can:crud.families.index');
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\FamilyController;
    ```
7. Crear componente Livewire para Tabla Families: 
	+ $ php artisan make:livewire crud/families-table
8. Programar controlador para la tabla Families: **app\Http\Livewire\Crud\FamiliesTable.php**:
    + Ver código en el repositorio.
9.  Diseñar vista para la tabla Families: **resources\views\livewire\crud\families-table.blade.php**:
    + Ver código en el repositorio.
10. Programar controlador Family: **app\Http\Controllers\FamilyController.php**:
    + Ver código en el repositorio.
11. Diseñar las vistas para el CRUD Familiares:
	- resources\views\crud\families\index.blade.php
	- resources\views\crud\families\create.blade.php
	- resources\views\crud\families\edit.blade.php
12. Editar **config\adminlte.php** para añadir los menú para ingresar al CRUD Familiares:
    + Ver código en el repositorio.
13. Commit:
	+ $ git add .
	+ $ git commit -m "CRUD Familiares"


## CRUD Tipos de documentos
1. Crear modelo TFile (tipo de documentos) junto con su migración y controlador y los métodos para el CRUD:
	+ $ php artisan make:model TFile -m -c -r
2. Preparar migración para la tabla **t_files** en **database\migrations\2021_04_01_143943_create_t_files_table.php**:
	```php
    ≡
    public function up()
    {
        Schema::create('t_files', function (Blueprint $table) {
            $table->id();
            $table->string('tipo')->unique();
            $table->string('notas')->nullable();
            $table->timestamps();
        });
    }
	≡
    ```
3. Establecer permisos en los seeders para el CRUD TFiles en **database\seeders\RoleSeeder.php**:
	```php
    ≡ 
    public function run()
    {
        ≡        
        Permission::create(['name' => 'crud.t_files.index'])->syncRoles($rolAdministrador, $rolGenealogista);
        Permission::create(['name' => 'crud.t_files.create'])->syncRoles($rolAdministrador, $rolGenealogista);
        Permission::create(['name' => 'crud.t_files.edit'])->syncRoles($rolAdministrador, $rolGenealogista);
        Permission::create(['name' => 'crud.t_files.destroy'])->syncRoles($rolAdministrador);
        ≡
    }
    ≡
    ```
4. Reestablecer base de datos: 
	+ $ php artisan migrate:fresh --seed
5. Establecer campos de asignación masiva en el modelo **TFile** en **app\Models\TFile.php**:
	```php
    ≡
    class TFile extends Model
    {
        use HasFactory;

        protected $fillable = [
            'tipo',
            'notas',
        ];
    }
    ```
6. Agregar ruta t_files al grupo de rutas CRUD:
	```php
    Route::resource('t_files', TFileController::class)->names('t_files')
            ->middleware('can:crud.t_files.index');
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\TFileController;
    ```
7. Crear componente Livewire para Tabla TFiles: 
	+ $ php artisan make:livewire crud/t_files-table
8. Programar controlador para la tabla TFiles: **app\Http\Livewire\Crud\TFilesTable.php**:
	+ Ver código fuente en el repositorio.
9.  Diseñar vista para la tabla TFiles: **resources\views\livewire\crud\t-files-table.blade.php**:
	+ Ver código fuente en el repositorio.
10. Programar controlador TFile: **app\Http\Controllers\TFileController.php**:
	+ Ver código fuente en el repositorio.
11. Diseñar las vistas para el CRUD TFiles:
	- resources\views\crud\t_files\index.blade.php
	- resources\views\crud\t_files\create.blade.php
	- resources\views\crud\t_files\edit.blade.php
12. Editar **config\adminlte.php** para añadir los menú para ingresar al CRUD TFiles:
	+ Ver código fuente en el repositorio.
13. Commit:
	+ $ git add .
	+ $ git commit -m "CRUD Tipos de documentos"


## Seeders Tipos de documentos
1. Crear seeder para tipos de documentos:
	+ $ php artisan make:seeder TFileSeeder
2. Añadir a cabecera de **database\seeders\TFileSeeder.php**
	```php
	use App\Models\TFile;
    ```
3. Modificar el método **run** de **database\seeders\TFileSeeder.php**
	```php
    public function run()
    {
        TFile::create(['tipo' => 'Nacimiento','Notas' => 'Documentos relaciones con los datos de nacimiento de una persona']);
        TFile::create(['tipo' => 'Bautizo','Notas' => 'Documentos relaciones con los datos de bautizo de una persona']);
        TFile::create(['tipo' => 'Matrimonio','Notas' => 'Documentos relaciones con los datos de matrimonio de una persona']);
        TFile::create(['tipo' => 'Defunción','Notas' => 'Documentos relaciones con los datos de defunción de una persona']);
        TFile::create(['tipo' => 'Identificación','Notas' => 'Documentos relaciones con la identidad de una persona']);
        TFile::create(['tipo' => 'Filiatorio','Notas' => 'Documentos cuyo fin son expresamente migratorios']);
        TFile::create(['tipo' => 'Otros','Notas' => 'Otros tipos de documentos']);
    }
    ```
4. Añadir al método run de **database\seeders\DatabaseSeeder.php**
	```php
    public function run()
    {
        ≡
        $this->call(TFileSeeder::class);
    }
    ```
5. Ejecutar: 
	+ $ php artisan migrate:fresh --seed
	+ **Nota**: Para correr los seeder sin resetear la base de datos:
	    + $ php artisan db:seed
6. Commit:
	+ $ git add .
	+ $ git commit -m "Seeder Tipos de documentos"


## CRUD Almacenamiento de documentos
1. Crear modelo File junto con su migración y controlador y los métodos para el CRUD:
	+ $ php artisan make:model File -m -c -r
2. Preparar migración para la tabla **Files** en **database\migrations\2021_03_31_184533_create_files_table.php**
	```php
    ≡
    public function up()
    {
        Schema::create('files', function (Blueprint $table) {
            $table->id();
            $table->string('file');                     // Nombre del archivo
            $table->string('location');                 // Ubicación del archivo
            $table->string('tipo')->nullable();         // Tipo de documento
            $table->string('propietario')->nullable();  // Nombre del propietario del documento
            $table->string('IDCliente')->nullable();    // IDCliente del propietario del documento
            $table->string('notas')->nullable();        // Notas
            $table->integer('IDPersona');               // ID de persona
            $table->unsignedBigInteger('user_id');      // Relación con los usuarios
            $table->foreign('user_id')
                ->references('id')
                ->on('users')
                ->onDelete('cascade');
            $table->timestamps();
        });
    }
    ≡
    ```
3. Establecer permisos en los seeders para el CRUD Documentos en **database\seeders\RoleSeeder.php**:
	```php
    ≡ 
    public function run()
    {
        ≡        
        Permission::create(['name' => 'crud.files.index'])->syncRoles($rolAdministrador, $rolGenealogista,$rolDocumentalista,$rolProduccion,$rolCliente);
        Permission::create(['name' => 'crud.files.create'])->syncRoles($rolAdministrador, $rolGenealogista,$rolDocumentalista,$rolProduccion,$rolCliente);
        Permission::create(['name' => 'crud.files.edit'])->syncRoles($rolAdministrador, $rolGenealogista,$rolDocumentalista,$rolProduccion,$rolCliente);
        Permission::create(['name' => 'crud.files.destroy'])->syncRoles($rolAdministrador);
        ≡
    }
    ≡
    ```
4. Reestablecer base de datos: 
	+ $ php artisan migrate:fresh --seed
5. Indicar campos de asignación masiva en el modelo **File** en **app\Models\File.php**:
	```php
    ≡
    class File extends Model
    {
        use HasFactory;

        protected $fillable = [
            'file',
            'location',
            'tipo',
            'propietario',
            'IDCliente',
            'notas',
            'IDPersona',
            'user_id'
        ];

    }
    ```
6. Agregar ruta files al grupo de rutas CRUD:
	```php
    Route::resource('files', FileController::class)->names('files')
            ->middleware('can:crud.files.index');
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\FileController;
    ```
7. Crear componente Livewire para Tabla Files: 
	+ $ php artisan make:livewire crud/files-table
8. Programar controlador para la tabla Files: **app\Http\Livewire\Crud\FilesTable.php**:
    + Ver código fuente en el repositorio.
9. Diseñar vista para la tabla Files: **resources\views\livewire\crud\files-table.blade.php**:
    + Ver código fuente en el repositorio.
10. Programar controlador File: **app\Http\Controllers\FileController.php**:
    + Ver código fuente en el repositorio.
11. Diseñar las vistas para el CRUD Files:
	- resources\views\crud\files\index.blade.php
	- resources\views\crud\files\create.blade.php
	- resources\views\crud\files\edit.blade.php
12. Editar **config\adminlte.php** para añadir los menú para ingresar al CRUD Files:
    + Ver código fuente en el repositorio.
13. Commit:
	+ $ git add .
	+ $ git commit -m "CRUD Almacenamiento de documentos"


## CRUD Libros
1. Crear modelo Book junto con su migración y controlador y los métodos para el CRUD:
	+ $ php artisan make:model Book -m -c -r
2. Preparar migración para la tabla **books** en **database\migrations\2021_05_08_140616_create_books_table.php**:
	```php
    ≡
    public function up()
    {
        Schema::create('books', function (Blueprint $table) {
            $table->id();
            $table->string('id_bd',4)->nullable();      // id correspondiente en la tabla bd
            $table->string('titulo');
            $table->string('subtitulo')->nullable();
            $table->string('autor')->nullable();
            $table->string('editorial')->nullable();    // Ciudad / Editorial
            $table->string('coleccion')->nullable();    // Colección, Serie, Número
            $table->string('fecha')->nullable();      	// Fecha de edición
            $table->string('edicion')->nullable();      // Número de edición
            $table->string('paginacion')->nullable();
            $table->string('isbn')->nullable();
            $table->text('notas')->nullable();
            $table->string('enlace');                   // Enlace o url del documento
            $table->text('claves')->nullable();         // Palabras claves
            $table->string('catalogador')->nullable();  // Nombre o email del usuario que creo el documento
            $table->timestamps();
        });
    }
    ≡
    ```
3. Establecer permisos en los seeders para el CRUD Books en **database\seeders\RoleSeeder.php**:
	```php  
    ≡ 
    public function run()
    {
        ≡        
        Permission::create(['name' => 'crud.books.index'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.books.create'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.books.edit'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.books.destroy'])->syncRoles($rolAdministrador);
        ≡
    }
    ≡
    ```
4. Reestablecer base de datos: 
	+ $ php artisan migrate:fresh --seed
5. En phpMyAdmin pasar datos de la tabla existente bd a la nueva tabla books:
	+ Migrar campos:
        ```sql
        INSERT INTO books(
            books.id_bd, 
            books.titulo,
            books.autor,
            books.editorial,
            books.coleccion,
            books.edicion,
            books.paginacion,
            books.isbn,
            books.notas,
            books.enlace,
            books.claves
        )
        SELECT 
            bd.id,
            bd.documento,
            bd.responsabilidad,
            bd.editorial,
            bd.coleccion,
            bd.edicion,
            bd.colacion,
            bd.isbn,
            bd.notas,
            bd.enlace,
            bd.busqueda
        FROM  bd
        ```
	+ Actualizar fecha de publicación con el año:
        ```sql
        UPDATE `books` SET `fecha`='[anho_publicacion]/1/1' WHERE `id_bd` LIKE '1'
        ```
	+ Formula en Excel:
        ```
        ="UPDATE `books` SET `fecha`='"&T2&"/1/1' WHERE `id_bd` LIKE '"&A2&"';" (Fila 2)
        ```
	+ Donde: T[i]: anho_publicacion y A[i]: id
	+ Actualizar campos **created_at** y **updated_at** con la fecha actual:
        ```sql
		UPDATE `books` SET `created_at` = CURRENT_TIMESTAMP;
		UPDATE `books` SET `updated_at` = CURRENT_TIMESTAMP;
        ```
6. Establecer campos de asignación masiva en el modelo **Book** en **app\Models\Book.php**
	```php
    ≡
    class Book extends Model
    {
        use HasFactory;

        protected $fillable = [
            'titulo',
            'subtitulo',
            'autor',
            'editorial',
            'coleccion',
            'fecha',
            'edicion',
            'paginacion',
            'isbn',
            'notas',
            'enlace',
            'claves',
            'catalogador',
        ];
    }
    ```
7. Agregar ruta books al grupo de rutas CRUD:
	```php
    Route::resource('books', BookController::class)->names('books')
            ->middleware('can:crud.books.index');
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\BookController;
    ```
8. Crear componente Livewire para Tabla Books: 
	+ $ php artisan make:livewire crud/books-table
9.  Programar controlador para la tabla Books: **app\Http\Livewire\Crud\BookTable.php**:
	+ Ver código en el repositorio.
10. Diseñar vista para la tabla Books: **resources\views\livewire\crud\books-table.blade.php**
	+ Ver código en el repositorio.
11. Programar controlador Book: **app\Http\Controllers\BookController.php**
	+ Ver código en el repositorio.
12. Diseñar las vistas para el CRUD Books:
	- resources\views\crud\books\index.blade.php
	- resources\views\crud\books\create.blade.php
	- resources\views\crud\books\edit.blade.php
13. Editar **config\adminlte.php** para añadir los menú para ingresar al CRUD Books
	+ Ver código en el repositorio.
14. Commit:
	+ $ git add .
	+ $ git commit -m "CRUD Libros"


## CRUD Miscelaneos
1. Crear modelo Miscelaneo junto con su migración y controlador y los métodos para el CRUD:
	+ $ php artisan make:model Miscelaneo -m -c -r
2. Preparar migración para la tabla **miscelaneos** en **database\migrations\2021_06_13_204842_create_miscelaneos_table.php**:
	```php
    ≡
    public function up()
    {
        Schema::create('miscelaneos', function (Blueprint $table) {
            $table->id();
            $table->string('id_bd',4)->nullable();      // id correspondiente en la tabla bd
            $table->string('titulo');                   // Título
            $table->string('autor')->nullable();        // Autor(es)
            $table->string('publicado')->nullable();    // Publicado en
            $table->string('editorial')->nullable();    // Ciudad / Editorial
            $table->string('volumen')->nullable();      // Año / Número / Volumen
            $table->string('paginacion')->nullable();   // Paginación
            $table->string('isbn')->nullable();         // ISBN / ISSN
            $table->text('claves')->nullable();         // Palabras claves
            $table->string('enlace');                   // Enlace o url del documento
            $table->text('notas')->nullable();          // Notas
            $table->string('material')->nullable();     // Tipo de material:    - Artículo de publicación periódica
                                                        //                      - Capítulo de libro
                                                        //                      - Material genealógico
                                                        //                      - Informes de Sefar
                                                        //                      - Otros
            $table->string('catalogador')->nullable();  // Nombre o email del usuario que creo el documento
            $table->timestamps();
        });
    }
    ≡
    ```
3. Establecer permisos en los seeders para el CRUD Miscelaneos en **database\seeders\RoleSeeder.php**:
	```php
    ≡ 
    public function run()
    {
        ≡        
        Permission::create(['name' => 'crud.miscelaneos.index'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.miscelaneos.create'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.miscelaneos.edit'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.miscelaneos.destroy'])->syncRoles($rolAdministrador);
        ≡
    }
    ≡
    ```
4. Reestablecer base de datos: 
	+ $ php artisan migrate:fresh --seed		
5. Establecer campos de asignación masiva en el modelo **Miscelaneo** en **app\Models\Miscelaneo.php**:
	```php
    ≡
    class Miscelaneo extends Model
    {
        use HasFactory;

        protected $fillable = [
            'titulo',
            'autor',
            'publicado',
            'editorial',
            'volumen',
            'paginacion',
            'isbn',
            'notas',
            'enlace',
            'claves',
            'material',
            'catalogador',
        ];
    }
    ```
6. Agregar ruta miscelaneos al grupo de rutas CRUD:
	```php
    Route::resource('miscelaneos', MiscelaneoController::class)->names('miscelaneos')
            ->middleware('can:crud.miscelaneos.index');
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\MiscelaneoController;
    ```
7. Crear componente Livewire para Tabla Miscelaneos: 
	+ $ php artisan make:livewire crud/miscelaneos-table
8. Programar controlador para la tabla Miscelaneos: **app\Http\Livewire\Crud\MiscelaneosTable.php**:
    + Ver código en el repositorio.
9.  Diseñar vista para la tabla Miscelaneos: **resources\views\livewire\crud\miscelaneos-table.blade.php**:
    + Ver código en el repositorio.
10. Programar controlador Miscelaneo: **app\Http\Controllers\MiscelaneoController.php**:
    + Ver código en el repositorio.
11. Diseñar las vistas para el CRUD Miscelaneos:
	- resources\views\crud\miscelaneos\index.blade.php
	- resources\views\crud\miscelaneos\create.blade.php
	- resources\views\crud\miscelaneos\edit.blade.php
12. Editar **config\adminlte.php** para añadir los menú para ingresar al CRUD Miscelaneos:
    + Ver código en el repositorio.
13. Commit:
	+ $ git add .
	+ $ git commit -m "CRUD Miscelaneos"


## CRUD Biblioteca
1. Crear modelo Library junto con su migración y controlador y los métodos para el CRUD:
	+ $ php artisan make:model Library -m -c -r
2. Preparar migración para la tabla **libraries** en **database\migrations\2021_04_11_155101_create_libraries_table.php**
	```php
    ≡
    public function up()
    {
        Schema::create('libraries', function (Blueprint $table) {
            $table->id();
            $table->string('documento')->unique();              // Nombre del documento
            $table->string('formato',12)->nullable();           // Formato del documento
            $table->string('tipo',45)->nullable();              // Tipo del documento
            $table->string('fuente')->nullable();               // Fuente del documento
            $table->string('origen')->nullable();               // Origen del documento
            $table->string('ubicacion')->nullable();            // Ubicación actual del documento
            $table->string('ubicacion_ant')->nullable();        // Ubicación anterior del documento
            $table->text('busqueda')->nullable();               // Palabras que faciliten la búsqueda del documento
            $table->text('notas')->nullable();                  // Notas para el documento
            $table->string('enlace')->nullable();               // Enlace o url del documento
            $table->string('anho_ini',11)->nullable();          // Año inicial al que hacer referencia el documento
            $table->string('anho_fin',11)->nullable();          // Año final al que hacer referencia el documento
            $table->string('pais')->nullable();                 // País al que hacer referencia el documento
            $table->string('ciudad',150)->nullable();           // Ciudad al que hacer referencia el documento
            $table->dateTime('FIncorporacion')->nullable();     // Fecha de incorporación
            $table->string('responsabilidad',150)->nullable();  // Mención de responsabilidad
            $table->string('edicion',150)->nullable();          // Edición del documento
            $table->string('editorial',150)->nullable();        // Editorial, ciudad
            $table->integer('anho_publicacion')->nullable();    // Año de publicación
            $table->string('no_vol',50)->nullable();            // Número y volumen
            $table->string('coleccion',100)->nullable();        // Colección
            $table->string('colacion',50)->nullable();          // Colación
            $table->string('isbn',50)->nullable();              // ISBN o ISSN
            $table->string('serie',50)->nullable();             // Serie
            $table->string('no_clasificacion',50)->nullable();  // Número de clasificación
            $table->string('titulo_revista')->nullable();       // Título de la revista
            $table->text('resumen')->nullable();                // Resumen del documento
            $table->string('caratula_url')->nullable();         // Ubicación de la caratula
            $table->string('usuario')->nullable();              // Nombre o email del usuario que creo el documento
            $table->timestamps();
        });
    }
    ≡
    ```php
3. Establecer permisos en los seeders para el CRUD Biblioteca en **database\seeders\RoleSeeder.php**:
	```php
    ≡ 
    public function run()
    {
        ≡        
        Permission::create(['name' => 'crud.libraries.index'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.libraries.create'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.libraries.edit'])->syncRoles($rolAdministrador,$rolGenealogista,$rolDocumentalista);
        Permission::create(['name' => 'crud.libraries.destroy'])->syncRoles($rolAdministrador);
        ≡
    }
    ≡
    ```
4. Reestablecer base de datos: 
	+ $ php artisan migrate:fresh --seed
5. Configurar modelo **Library** en **app\Models\Library.php**:
	```php
    ≡
    class Library extends Model
    {
        use HasFactory;

        protected $fillable = [
            'documento',
            'formato',
            'tipo',
            'fuente',
            'origen',
            'ubicacion',
            'ubicacion_ant',
            'busqueda',
            'notas',
            'enlace',
            'anho_ini', 
            'anho_fin',
            'pais',
            'ciudad',
            'FIncorporacion',
            'responsabilidad',
            'edicion',
            'editorial',
            'anho_publicacion',
            'no_vol',
            'coleccion',
            'colacion',
            'isbn',
            'serie',
            'no_clasificacion',
            'titulo_revista',
            'resumen',
            'caratula_url',
            'usuario'
        ];
    }
    ```
6. Agregar ruta de paises al grupo de rutas CRUD:
	```php
    Route::resource('libraries', LibraryController::class)->names('libraries')
            ->middleware('can:crud.libraries.index');
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\LibraryController;
    ```
7. Crear componente Livewire para Tabla Libraries: 
	+ $ php artisan make:livewire crud/libraries-table
8. Programar controlador para la tabla Libraries: **app\Http\Livewire\Crud\LibrariesTable.php**:
    + Ver código en el repositorio.
9. Diseñar vista para la tabla Libraries: **resources\views\livewire\crud\libraries-table.blade.php**:
    + Ver código en el repositorio.
10. Programar controlador Library: **app\Http\Controllers\LibraryController.php**:
    + Ver código en el repositorio.
11. Diseñar las vistas para el CRUD Paises:
	- resources\views\crud\libraries\index.blade.php
	- resources\views\crud\libraries\create.blade.php
	- resources\views\crud\libraries\edit.blade.php
12. Editar **config\adminlte.php** para añadir los menú para ingresar al CRUD Biblioteca:
    + Ver código en el repositorio.
13. Commit:
	+ $ git add .
	+ $ git commit -m "CRUD Biblioteca"


## Componentes de formularios modales para vistas de árboles
1. Creación de **resources\views\components\editar-persona.blade.php** para la edición de personas en el árbol:
    + Ver código en el repositorio.
2. Creación de **resources\views\components\ver-doc.blade.php** para ver documentos cargados.:
    + Ver código en el repositorio.
3. Creación de **resources\views\components\cargar-doc.blade.php** para la carga de documentos:
    + Ver código en el repositorio.


## Vista árbol genealógico: **Albero**
1. Crear controlador Albero:
	+ $ php artisan make:controller AlberoController
2. Programar controlador Albero en **app\Http\Controllers\AlberoController.php**:
    + Ver código en el repositorio.
3. Crear la vista Albero **resources\views\arboles\arbelo.blade.php**:
    + Ver código en el repositorio.
4. Crear grupo de rutas para las vistas de árboles y agregar la ruta para la vista Albero:
	```php
		// Grupo de rutas para vistas de árboles genealógicos
		Route::group(['middleware' => ['auth'], 'as' => 'arboles.'], function(){
			Route::get('albero', [AlberoController::class, 'arbelo'])->name('albero.index')
				->middleware('can:genealogista');
		});
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\AlberoController;
    ```
5. Crear componente Livewire para la vista Albero: 
	+ $ php artisan make:livewire vistas/arbol/albero-vista
6. Programar controlador para la vista Albero: **app\Http\Livewire\Vistas\Arbol\AlberoVista.php**:
    + Ver código en el repositorio.
7. Crear archivo de estilo para diagramar el árbol en **public\css\arbelo.css**::
    + Ver código en el repositorio.
8. Diseñar vista livewire para la tabla Albero: **resources\views\livewire\crud\arbelo-table.blade.php**:
    + Ver código en el repositorio.
9. Commit --:
	+ $ git add .
	+ $ git commit -m "Vista Arbelo"


## Creación de enlaces simbólicos (symbolic link)
1. Crear enlace simbólico en Windows 10:
	+ Ejecutar **C:\Windows\System32\cmd.exe como administrador**
	+ $ Mklink/D C:\xampp\htdocs\sefar\public\doc C:\xampp\htdocs\sefaruniversal.com\documentos
	+ $ Mklink/D C:\xampp\htdocs\sefar\storage\app\public\doc C:\xampp\htdocs\sefaruniversal.com\documentos
		+ Mklink /D "ruta donde queremos crear el enlace" "ruta de origen de archivos"
2. Crear enlace simbólico en el hosting:
	+ En el cPanel ir a **Trabajos de cron**.
	+ Ubicarse en **Añadir nuevo trabajo de cron** y luego **Configuración común**, y seleccionar **Una vez por mínuto(* * * * *)**.
	+ En **Comando:** escribir:
		* ln -s /home/pxvim6av41qx/public_html/documentos /home/pxvim6av41qx/public_html/app.sefaruniversal.com/public/doc
	+ Presionar **Añadir nuevo trabajo de cron** y esperar a que se ejecute la tarea.
	+ Borrar tarea una vez creado el enlace en **Trabajos de cron actuales**.
	+ Repetir el procedimiento pero ahora para:
		* ln -s /home/pxvim6av41qx/public_html/documentos /home/pxvim6av41qx/public_html/app.sefaruniversal.com/storage/app/public/doc


## Vista árbol genealógico: **Horizontal**
1. Crear controlador Tree:
	+ $ php artisan make:controller TreeController
2. Programar controlador Tree en **app\Http\Controllers\TreeController.php**:
    + Ver código en el repositorio.
3. Crear la vista Tree **resources\views\arboles\tree.blade.php**:
    + Ver código en el repositorio.
4. Agregar la ruta para la vista Tree en el grupo de rutas de árboles.
	```php
    // Grupo de rutas para vistas de árboles genealógicos
    Route::group(['middleware' => ['auth'], 'as' => 'arboles.'], function(){
        ≡
        Route::get('tree/{IDCliente}', [TreeController::class, 'tree'])->name('tree.index')
            ->middleware('can:genealogista');
    });
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\TreeController;
    ```
5. Crear componente Livewire para la vista Tree: 
	+ $ php artisan make:livewire vistas/arbol/tree-vista
6. Programar controlador para la vista Tree: **app\Http\Livewire\Vistas\Arbol\TreeVista.php**:
    + Ver código en el repositorio.
7. Crear archivo de estilo para diagramar el árbol en **public\css\tree.css**:
    + Ver código en el repositorio.
8. Diseñar vista livewire para la tabla Trees: **resources\views\livewire\vistas\arbol\tree-vista.blade.php**:
    + Ver código en el repositorio.
9. Commit:
	+ $ git add .
	+ $ git commit -m "Vista Tree"


## Vista árbol genealógico: **Vertical**
1. Crear controlador Olivo:
	+ $ php artisan make:controller OlivoController
2. Programar controlador Tree en **app\Http\Controllers\OlivoController.php**:
    + Ver código en el repositorio.
3. Crear la vista Olivo **resources\views\arboles\olivo.blade.php**:
    + Ver código en el repositorio.
4. Agregar la ruta para la vista Olivo en el grupo de rutas de árboles.
    ```php
    // Grupo de rutas para vistas de árboles genealógicos
    Route::group(['middleware' => ['auth'], 'as' => 'arboles.'], function(){
        ≡
        Route::get('olivo/{IDCliente}', [OlivoController::class, 'olivo'])->name('olivo.index')
            ->middleware('can:genealogista');
    });
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\OlivoController;
    ```
5. Crear componente Livewire para la vista Olivo: 
	+ $ php artisan make:livewire vistas/arbol/olivo-vista
6. Programar controlador para la vista Olivo: **app\Http\Livewire\Vistas\Arbol\OlivoVista.php**:
    + Ver código en el repositorio.
7. Crear archivo de estilo para diagramar el árbol en **public\css\olivo.css**:
    + Ver código en el repositorio.
8. Diseñar vista livewire para la tabla Olivos: **resources\views\livewire\vistas\arbol\olivo-vista.blade.php**:
    + Ver código en el repositorio.
9. Commit:
	+ $ git add .
	+ $ git commit -m "Vista Olivo"


## CRUD Agclientes
1. Crear modelo Agcliente junto con su migración y controlador y los métodos para el CRUD:
	+ $ php artisan make:model Agcliente -m -c -r
2. Preparar migración para la tabla **agclientes** en **database\migrations\2021_03_23_020633_create_agclientes_table.php**:
    + Ver código en el repositorio.
3. Establecer permisos en los seeders para el CRUD Paises en **database\seeders\RoleSeeder.php**
	```php
    ≡ 
    public function run()
    {
        ≡
        Permission::create(['name' => 'crud.agclientes.index'])->syncRoles($rolAdministrador, $rolGenealogista, $rolCliente);
        Permission::create(['name' => 'crud.agclientes.create'])->syncRoles($rolAdministrador, $rolGenealogista, $rolCliente);
        Permission::create(['name' => 'crud.agclientes.edit'])->syncRoles($rolAdministrador, $rolGenealogista, $rolCliente);
        Permission::create(['name' => 'crud.agclientes.destroy'])->syncRoles($rolAdministrador);
        ≡
    }
    ≡
    ```
4. Reestablecer base de datos: 
	+ $ php artisan migrate:fresh --seed	
5. Configurar modelo **Agcliente** en **app\Models\Agcliente.php**
	```php
    ≡
    class Country extends Model
    {
        use HasFactory;

        protected $fillable = [
            'IDCliente',
            'IDPersona',
            'IDPadre',
            'IDMadre',
            'Generacion',
            'Nombres',
            'Apellidos',
            'NPasaporte',
            'PaisPasaporte',
            'NDocIdent',
            'PaisDocIdent',
            'Sexo',
            'AnhoNac',
            'MesNac',
            'DiaNac',
            'LugarNac',
            'PaisNac',
            'AnhoBtzo',
            'MesBtzo',
            'DiaBtzo',
            'LugarBtzo',
            'PaisBtzo',
            'AnhoMatr',
            'MesMatr',
            'DiaMatr',
            'LugarMatr',
            'PaisMatr',
            'AnhoDef',
            'MesDef',
            'DiaDef',
            'LugarDef',
            'PaisDef',
            'Vive',
            'Observaciones',
            'Familiaridad',
            'NombresF',
            'ApellidosF',
            'ParentescoF',
            'NPasaporteF',
            'FRegistro',
            'PNacimiento',
            'LNacimiento',
            'Familiares',
            'Enlace',
            'referido',
            'FTM',
            'FUpdate',
            'Usuario',
        ];
    }
    ```
6. Agregar ruta de agclientes al grupo de rutas CRUD:
	```php
    Route::resource('agclientes', AgclienteController::class)->names('agclientes')
            ->middleware('can:crud.agclientes.index');
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\AgclienteController;
    ```
7. Crear componente Livewire para Tabla Agclientes: 
	+ $ php artisan make:livewire crud/agclientes-table
8. Programar controlador para la tabla Agclientes: **app\Http\Livewire\Crud\AgclientesTable.php**:
    + Ver código en el repositorio.
9.  Diseñar vista para la tabla Agcliente: **resources\views\livewire\crud\agclientes-table.blade.php**:
    + Ver código en el repositorio.
10. Programar controlador Agcliente: **app\Http\Controllers\AgclienteController.php**:
    + Ver código en el repositorio.
11. Diseñar las vistas para el CRUD Agclientes:
	- resources\views\crud\agclientes\index.blade.php
	- resources\views\crud\agclientes\create.blade.php
	- resources\views\crud\agclientes\edit.blade.php
12. Editar **config\adminlte.php** para añadir los menú para ingresar al CRUD Agclientes:
    + Ver código en el repositorio.
13. Commit:
	+ $ git add .
	+ $ git commit -m "CRUD Agclientes"


## Seeders para prueba de agclientes
1. Crear seeder para agclientes:
	+ $ php artisan make:seeder AgclienteSeeder
2. Añadir a cabecera de **database\seeders\CountrySeeder.php**:
	```php
	use App\Models\Agcliente;
    ```
3. Modificar el método **run** de **database\seeders\AgclienteSeeder.php**:
    + Ver código en el repositorio.
4. Añadir al método run de **database\seeders\DatabaseSeeder.php**
	```php
    public function run()
    {
        ≡
        $this->call(AgclienteSeeder::class);
    }
    ```
5. Crear directorio **storage\app\public\imagenes\paises** y guardar la imagenes de los paises iniciales en formato png y en baja resolución.
6. Ejecutar: 
	+ $ php artisan migrate:fresh --seed
	+ **Nota**: Para correr los seeder sin resetear la base de datos:
    	+ $ php artisan db:seed
7. Commit:
	+ $ git add .
	+ $ git commit -m "Seeder Paises"


## Consultar BD Onidex
1. Agregar las variables de entorno para la conexión a la base de datos **onidex** en **.env**:
	```
    ≡
    ONIDEX_CONNECTION=mysql
    ONIDEX_HOST=127.0.0.1
    ONIDEX_PORT=3306
    ONIDEX_DATABASE=onidex
    ONIDEX_USERNAME=root
    ONIDEX_PASSWORD=
    ≡
    ```
2. Agregar a **config\database.php** los parámetros de conexión a la base de datos **onidex**:
	```php
    ≡
    'connections' => [
        ≡
        'onidex' => [
            'driver' => 'mysql',
            'url' => env('DATABASE_URL'),
            'host' => env('ONIDEX_HOST', '127.0.0.1'),
            'port' => env('ONIDEX_PORT', '3306'),
            'database' => env('ONIDEX_DATABASE', 'forge'),
            'username' => env('ONIDEX_USERNAME', 'forge'),
            'password' => env('ONIDEX_PASSWORD', ''),
            'unix_socket' => env('ONIDEX_SOCKET', ''),
            'charset' => 'utf8',
            'collation' => 'utf8_general_ci',
            'prefix' => '',
            'prefix_indexes' => true,
            'strict' => true,
            'engine' => null,
            'options' => extension_loaded('pdo_mysql') ? array_filter([
                PDO::MYSQL_ATTR_SSL_CA => env('MYSQL_ATTR_SSL_CA'),
            ]) : [],
        ],		   
        ≡
    ],
    ≡
    ```
	+ **Nota**: No se crearan migraciones debido a que solo se realizaran consultas a una base de datos existente y externa para nuestro proyecto. 
	+ Para consultar conexiones múltiples en Laravel: https://styde.net/multiples-bases-de-datos-con-laravel-5-y-eloquent
3. Crear modelo Onidex:
	+ $ php artisan make:model Onidex
4. Programar modelo Onidex: **app\Models\Onidex.php**:
	```php
    <?php

    namespace App\Models;

    use Illuminate\Database\Eloquent\Factories\HasFactory;
    use Illuminate\Database\Eloquent\Model;

    class Onidex extends Model
    {
        use HasFactory;

        /**
        * The database connection used by the model.
        *
        * @var string
        */
        protected $connection = 'onidex';

        /**
        * The database table used by the model.
        *
        * @var string
        */
        protected $table = 'onidexes';
    }
    ```
5. Crear controlador Onidex:
	+ $ php artisan make:controller OnidexController
6. Programar controlador Onidex **app\Http\Controllers\OnidexController.php**:
	+ Ver código en el repositorio.
7. Crear componente Livewire para Tabla **onidexes**: 
	+ $ php artisan make:livewire consulta/onidexes-table
8. Programar controlador para la tabla **onidexes**: **app\Http\Livewire\Consulta\OnidexesTable.php**:
	+ Ver código en el repositorio.
9.  Diseñar vista para la tabla **onidexes**: **resources\views\livewire\crud\users-table.blade.php**:
	+ Ver código en el repositorio.
10. Crear y diseñar vista principal Onidex: **resources\views\consultas\onidex\index.blade.php**:
	+ Ver código en el repositorio.
11. Crear grupo de rutas para consultas en **routes\web.php**:
	```php
    // Grupo de rutas para Consultas a base de datos
    Route::group(['middleware' => ['auth'], 'as' => 'consultas.'], function(){
    });
    ```
12. Agregar rutas **onidex.index** y **onidex.show** en el grupo de rutas para consultas en **routes\web.php**:
	```php
    Route::get('consultaodx', [OnidexController::class, 'index'])->name('onidex.index')
            ->middleware('can:consultas.onidex.index');
    Route::post('consultaodx', [OnidexController::class, 'show'])->name('onidex.show')
            ->middleware('can:consultas.onidex.show');
    ```
	+ **Nota**: añadir a la cabecera:
	```php
	use App\Http\Controllers\OnidexController;
    ```
13. Crear y diseñar vista para mostrar registros Onidex: **resources\views\consultas\onidex\show.blade.php**:
	+ Ver código en el repositorio.
14. Commit:
	+ $ git add .
	+ $ git commit -m "App Consulta BD Onidex"
